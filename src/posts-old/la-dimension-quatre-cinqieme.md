---
title: 四维几何学 5－超球与双旋转
tags:
  - 四维
  - 几何
  - Mathematica
  - POV-Ray
keywords: '四维空间,几何学,超球,Hopf纤维丛,双旋转'
date: 2016-04-28 17:47:26
category: Old blog/四维几何学
layout: post
indent: true
---
在[这篇文章](/2016/04/21/axial-vectors/)里面我们曾提到过四维空间中的双旋转，下面我们进一步的来讨论一下。由于在超球上的圆周可以球极投影，更便于可视化，所以我们将从超球面上的双旋转开始，会发现双旋转就是我们熟悉的李萨如图形的类比，之后我们会讨论双旋转与Hopf纤维丛的关系。文章最后介绍了双旋转矩阵的一般求法，并用这种方法解决了以前一篇文章中留下来的问题。
## 重点内容
* 双旋转的表示
* 四维空间中的李萨如图形类似物
* 环面上的双旋转轨迹的结构
* Hopf纤维丛
* 旋转生成元

<!-- more -->

## 四维空间中的旋转
我们知道，在三维空间中一个点可以在$Oxy$面中旋转，它的轨迹在$Oxy$面上的投影就是一个圆，那么在四维空间里面由于有四个坐标轴，那么一个旋转的点的轨迹就可以存在这种情况：这个轨迹在$Oxy$和$Ozt$面中的投影都是圆！注意这两个平面是绝对垂直的，所以它们是相互没有影响的，并且有可能这两个圆的半径和相位都不同。这种旋转我们称为**双旋转**。

我们也可以通过旋转矩阵的方式来看这种旋转模式。既然三维空间的旋转矩阵是一个3x3的方阵，那么四维空间的就是4x4的方阵。既然矩阵是4x4的那么就可能可以被分块，所以我们先考虑这么一个被分块了的旋转矩阵：
$$
{\bf\Lambda}=\begin{pmatrix}\cos\theta_1&-\sin\theta_1&0&0\\\sin\theta_1&\cos\theta_1&0&0\\0&0&\cos\theta_2&-\sin\theta_2\\0&0&\sin\theta_2&\cos\theta_2\end{pmatrix}
$$
把它代入到旋转变换的方程${\bf r}^\prime={\bf\Lambda}{\bf r}$中，我们发现坐标$(x,y)$与坐标$(z,t)$在这个旋转变换下是相互独立的：
$$
\begin{pmatrix}x^\prime\\y^\prime\end{pmatrix}=\begin{pmatrix}\cos\theta_1&-\sin\theta_1\\\sin\theta_1&\cos\theta_1\end{pmatrix}\begin{pmatrix}x\\y\end{pmatrix}
$$
$$
\begin{pmatrix}z^\prime\\t^\prime\end{pmatrix}=\begin{pmatrix}\cos\theta_2&-\sin\theta_2\\\sin\theta_2&\cos\theta_2\end{pmatrix}\begin{pmatrix}z\\t\end{pmatrix}
$$
也就是说，整个空间中除了原点其他的点都在旋转！和二维空间还有点类似哦。空间中的每一点都有一个线速度矢量，这些矢量就构成了四维空间中的一个矢量场，称为**双旋转场**，它的场线其实就是这些点的轨迹。二维空间的旋转场的场线是一个个同心圆，那么四维空间的双旋转呢？这就有点抽象了，不过我们知道旋转是不会改变一个点与原点的距离的，双旋转也一样，所以参与双旋转的这些点的轨迹都在一族以原点为球心的同心超球上！因此我们就可以通过球极投影来观察它们。

既然一个双旋转的点的轨迹在$Oxy$和$Ozt$上的投影是两个半径可能不同圆，那么如果这个点是在单位超球上就一定满足这两个半径的平方和为1，为了方便我们就分别把它们设为$\cos\varphi$和$\sin\varphi$。这样我们就可以写出一个双旋转的点的参数方程：
$$
\begin{cases}
x=\cos\theta_1\cos\varphi\\
y=\sin\theta_1\cos\varphi\\
z=\sin\varphi\cos(\theta_2+\alpha)\\
t=\sin\varphi\sin(\theta_2+\alpha)
\end{cases}
$$
如果以时间为参数的话那么$\theta_1 = \omega_1 t$以及$\theta_2 = \omega_2 t$。把这个方程代入球极投影的公式$\vec{x}=2\vec{x} / (1-t)$就得到我们想要的双旋转轨迹的球极投影了，由于方程有点复杂这里我就不写出来了。

那么参数$\varphi$的意义是什么呢？双旋转也是一种圆周运动，所以它的轨迹其实就是一个单位圆。而这个单位圆就是这个点旋转所在平面内的一个圆，它在$Oxy$和$Ozt$面内的投影也是圆，半径分别为$\cos\varphi$和$\sin\varphi$。那么，根据前面文章里面讲的单位圆投影法我们就知道这个点旋转的所在平面与$Oxy$和$Ozt$都是**等角平面**！$\varphi$就是这个平面与$Oxy$的最大角与最小角。所以这些双旋转的轨迹就是由一系列处在不同等角平面上的轨迹组成的。

## 李萨如图形的类比
既然双旋转分为两个相互独立的旋转，那么它就可以看成是在两个绝对垂直面上的两个圆周运动的合运动，这其实就是大学物理里面讲的在两个相互垂直方向上的简谐运动的类比！当这两个简谐运动的频率比取不同的值时合运动的轨迹就称为李萨如图形，那么双旋转的轨迹也是一样的！下面我们就来看一下当$\omega_1 / \omega_2$取不同值时的四维李萨如图形。

### $\frac{\omega_1}{\omega_2} = 1$
这是最简单的情况，投影是一个圆，和简谐振动一样。
![圆形轨迹](2016/circle.png)
### $\frac{\omega_1}{\omega_2} = \frac12$
![双叶结](2016/knot2.png)
### $\frac{\omega_1}{\omega_2} = 4$
![4比1](2016/m4-1.png)
### $\frac{\omega_1}{\omega_2} = \frac56$
这次我们把分子分母取得比较大，发现李萨如图形有点像环面：
![有点像环面了](2016/m5-6.png)
这暗示了可能这些轨迹都在一个环面上，下面我们会详细讲。
### $\frac{\omega_1}{\omega_2} = \frac23$
![三叶结](2016/trefoi.png)
这个图形叫做**三叶结**，它在拓扑学和纽结理论中经常出现。它的俯视图是这样的：
![三叶结](2016/trefoi-top.png)
数学中的三叶结一般指的是没被球极投影的三叶结。我记得大物实验中用示波器观察李萨如图形时当频率比为$2/3$时出现了一个和这个三叶结很像的图形，其实那就是三叶结在三维空间中的正交投影！

我们还可以让这些双旋转的轨迹在四维空间里面旋转，更好的了解它们的结构。比如下面就是在$Oyt$面中旋转的三叶结：
![旋转的三叶结](2016/trefoi.gif)

其实角速度比互为倒数的两个轨迹可以通过这样的在四维空间里面旋转相互转化，比如$\omega_1 / \omega_2 = 3/2$的轨迹是这样的：
![另一个三叶结（侧视图）](2016/trefoi2.png)
正好可以通过上面那个三叶结旋转得到。这也就意味着它们的形状其实是一样的，只是在四维空间中的摆放方向不同。

## 环面结构
上面我们看到的都只是某一个双旋转的点的轨迹，即$\varphi$和$\alpha$为常数时得到的曲线。为了进一步地了解整个超球上的双旋转的情况，我们同时画出多个轨迹看它们的相互关系。以圆形轨道为例，我们来看一下任意两个轨迹之间的关系：
![霍普夫连环](2016/hopf-link.png)
这两个轨迹是相互扣在一起的！这种两个圆的连环叫做**Hopf link**。它的出现正是超球上的双旋转轨道两两不相交的实际体现，不仅仅是圆轨道，其他比值的轨道也是像这样扣在一起的。

然后我们取多个$\alpha$的值然后同时画出这些轨迹。仍然取$\omega_1 / \omega_2 = 1$，我们得到这样的图形：
![环面](2016/torus1.png)
这些圆组成了一个环面！也就是说当$\varphi$为常数，即在角度相等的等角平面上的所有轨迹的投影都在一个环面上！这对其他的比值也是成立的，比如三叶结：
![环面与三叶结](2016/trefoi-torus.png)
要证明也不难，只是计算有点麻烦，不过还好有Mathematica，利用它不仅可以证明这些轨迹都在环面上，还可以计算出环面的大小半径分别为$R=2\sec\varphi$和$r=2\tan\varphi$（所以我才能同时画出三叶结和圆环）。

如果我们再改变$\phi$就可以得到一系列这样由一些圆（或四维李萨如图形）组成的环面，这些圆填满了整个三维空间，这就是整个超球上的双旋转轨迹的球极投影：
![整个空间的双旋转](2016/fibration.png)
这样我们就把超球上的双旋转场投影成了三维空间中的矢量场。这个填满整个三维空间的结构不仅是超球上双旋转场的球极投影，它也是**Hopf纤维丛**，我们马上就会讲到。现在我们知道了每个等角平面上的轨迹投影都有类似的结构，所以我们只需用搞清楚一个环面结构就可以了。

令$\omega_1 = 1,\omega_2 = 0$以及$\omega_1 = 0, \omega_2 = 1$就可以得到另外两簇轨迹，分别对应在$Oxy$面中的单旋转和$Ozt$面中的单旋转，它们和两簇$\omega_1 / \omega_2 = 1$的双旋转场线一起构成了环面上的四簇圆。为什么双旋转有两簇呢？这是因为它是有手性的，“左旋”双旋转场对应$\omega_1 / \omega_2 = -1$，“右旋”对应$\omega_1 / \omega_2 = 1$
![环面上的四簇圆](2016/cercles.png)
图上红色和蓝色的圆对应在$Oxy$和$Ozt$面中的单旋转，两簇不同方向的黄色圆代表两种手性的双旋转。为了能更清楚的看出这四簇圆的相交关系，我们分别画出四簇的一个圆：
![四簇圆中的一个](2016/torus2.png)
四个圆相交的那个点很好理解，可以认为它是旋转的起点。但我们发现两个黄色的圆在圆环的另一边也有一个交点，也就是说从一点出发分别沿左旋和右旋的两种轨迹旋转180度后会到达同一点，这就是四维空间中的反射变换！偶数维空间中可以通过旋转得到反射变换，如二维和四维空间，而奇数维则不行，因为奇数维有一个维度在旋转中不能被配对，在旋转完成后这个维度的坐标不能被反号。
## Hopf纤维丛
这部分内容都来自[维度数学漫步７：纤维丛](http://list.youku.com/albumlist/show?id=2376313&ascending=1&page=1)，大家可以到[官网](http://www.dimensions-math.org/Dim_CH7_ZH_si.htm)上看一下霍普夫纤维丛的介绍，wxy的文章[四维空间（四）：纤维与超球](http://wxyhly.github.io/2016/04/16/fibration4ds/)也对纤维丛有详细介绍。

我们刚刚看到的双旋转场的球极投影其实就是Hopf纤维丛的球极投影。下面我们简单讲一下Hopf纤维丛是怎么得到的。
既然四维空间有xyzt四个坐标，那么我就可以定义两个复数$z_1 = z + iy$和$z_2 = z + it$，这样就使得四维空间变成了一个复二维空间，从而简化了四维几何问题。空间中包含$z_1$和$z_2$两个坐标轴在在内的直线都是复直线，也就是一个实平面，它们在复二维空间中只交于一点。

为了得到纤维丛，Hopf在复平面中画了一条方程为$z_2=az_1$的直线，a是一个复数。我们知道复数相乘就等于模长相乘幅角相加，那么$z_2$与$z_1$就相差一个幅角，这样如果平面中的一个圆在$Oxy$面，即$z_1$轴上的投影是一个半径为1的圆，那么它在$z_2$上的投影就是半径为$|a|$的圆，所以这条复直线代表的平面就是我们上面说到的等角平面！

这个平面与单位超球$|z_2|^2 + |z_1|^2=1$会交于一个圆，这样对于每个复数a都对应一个圆，我们可以把这些圆球极投影下来，当a的模长一定时得到的一簇圆就是我们上面看到的环面！改变它的模长，我们就得到和双旋转场一样的图形了。

其实研究拓扑学的数学家对这种几何结构并不感兴趣，纤维丛也不是这样的一个几何图形，它其实也是一种映射。由于a是复数，我们知道二维球面${\bf S}^2$上的每一点都可以通过球极投影对应到复平面上，再加上北极点。而每一个复数a都对应${\bf S}^3$上的一个圆，这样，每个${\bf S}^2$上的点都对应${\bf S}^3$中的一个${\bf S}^2$，这样我们就建立了${\bf S}^1\to{\bf S}^3\to{\bf S}^2$的对应关系。关于纤维丛的严格定义大家可以到[维基百科](https://en.wikipedia.org/wiki/Fiber_bundle)或者wxy的文章上去看一下。

我们知道任意角速度比都可以得到环面结构，所以任意比值的双旋转场都可以得到一个纤维丛！Hopf纤维丛只是这类纤维丛中的一个特例。在模形式里面经常遇到三叶结纤维丛。在一般情形下纤维丛的映射关系就成了$李萨如图形\to{\bf S}^3\to{\bf S}^2$。
***
## 旋转生成元
好了，既然我们现在已经搞清楚双旋转了，那么我们唯一还想知道都就是怎么求任意双旋转的旋转矩阵。这可以用指数映射方法，即旋转矩阵可以写成${\bf\Lambda}=e^{A\theta}$，其中A称为**旋转生成元**，它就是旋转的角速度2-矢量的矩阵形式（可以去看一下[这篇文章](/2016/04/21/axial-vectors/)），只不过要求角速度是单位角速度，即大小为1。

那么怎么计算$e^{A\theta}$呢？维基上的[这个词条](https://en.wikipedia.org/wiki/Matrix_exponential#Rotation_case)讲到了计算方法，基本思路就是：我们可以证明$A^3=-A$，即A的指数次幂有周期性，所以我们可以把指数函数用泰勒级数展开，从而得到${\bf\Lambda}=I+A^2(1-\cos\theta)+A\sin\theta$，这样只要知道了“角速度”我们就可以很方便的得到旋转矩阵。这个方法不仅可以用于四维的双旋转，其他维的旋转也可以，不同的就只是生成元的矩阵阶数不同。像jenn3d这种四维可视化软件里面的鼠标旋转就可以用这种方法；在OpenGL程序中如果需要旋转坐标就可以直接写出旋转矩阵而不需要先转到坐标轴上再旋转了。

记得我以前的[一篇讲科里奥利力的文章](/article/2016/04/06/coriolis-force-derivation/)中有一个历史遗留问题，就是当角速度为任意值时的科里奥利力表达式。现在我们有了这种指数映射法就可以很方便的解决。

我们的角速度2-矢量为${\bf\omega}$，那么旋转的变换矩阵就可以写成${\bf\Lambda}=e^{\omega t}$，与上面的不同只在于这里的参数是时间。所以代入我们之前推出来的科里奥利力表达式我们得到
$$
\begin{align}
{\bf F}_2&=-2m{\bf\Lambda}^{-1}\dot{\bf\Lambda}\dot{\bf r}\\
&=-2me^{-\omega t}\omega e^{\omega t}\vec{v}\\
&=-2m{\bf\omega}\cdot\vec{v}\\
&=2m(\star\vec{\omega})\cdot\vec{v}=2m\vec{v}\times\vec{\omega}
\end{align}
$$
其中我们用到了角速度2-矢量的定义和公式$\vec{a}\times\vec{b}=\star(\vec{a}\land\vec{b})$以及$(\star\vec{a})\cdot\vec{b}=-\star(\vec{a}\land\vec{b})$，如果大家还不了解可以去看一下我的[这篇文章](/2016/04/21/axial-vectors/)。
其实在物理里面经常出现像$e^{F\alpha}$的指数映射，代表的都是一种变换群的元素，比如自旋群、洛伦兹群等，在以后的文章里面会涉及到。
***
## 思考题
我感觉前两道题难度有点大了，所以这次来一个简单的。在上面对双旋转的讨论中我们并没有单独讨论两个极端位置的轨迹——超球的北极点和南极点，其中南极点就是球极投影空间与超球的切点。你能想出北极点和南极点的轨迹的球极投影吗？
上次的答案：
三维环面是圆绕与它共面的旋转轴转出来的旋转面，那么我们有两种方法类比环面：
* 把球在一个面中旋转，即沿一个圆“[放样](http://baike.baidu.com/view/938814.htm)”，得到**球环**
* 把圆沿一个球“放样”，得到**环球**

这两个环面类比的方程分别为$(x^2+y^2+z^2+t^2+R^2-r^2)^2=4R^2(x^2+y^2)$和$(x^2+y^2+z^2+t^2+R^2-r^2)^2=4R^2(x^2+y^2+z^2)$。它们的截面动画分别为：

![球环](2016/torus4d3.gif)

![环球](2016/torus4d2.gif)