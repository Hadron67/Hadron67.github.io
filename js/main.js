!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";function t(t){if("string"==typeof t){var e=t.substr(1,t.length-1);"."===t.charAt(0)?this.elems=document.getElementsByClassName(e):"#"===t.charAt(0)?this.elems=[document.getElementById(e)]:this.elems=document.getElementsByTagName(t)}else void 0!==t.length?this.elems=t:this.elems=[t]}function e(e){return new t(e)}function n(){return document.documentElement.scrollTop||document.body.scrollTop}t.prototype.forEach=function(t){for(var e=0,n=this.elems;e<n.length;e++)if(t(n[e],e))return},t.prototype.addEventListener=function(t,e){return this.forEach(function(n){n.addEventListener(t,e)}),this},t.prototype.click=function(t){return this.addEventListener("click",t)},t.prototype.scroll=function(t){return this.addEventListener("scroll",t)},t.prototype.load=function(t){return this.addEventListener("load",t)},t.prototype.input=function(t){return this.addEventListener("input",t)},t.prototype.hasClass=function(t){for(var e=0,n=this.elems;e<n.length;e++)if(n[e].classList.contains(t))return!0;return!1},t.prototype.addClass=function(t){this.forEach(function(e){e.classList.add(t)})},t.prototype.removeClass=function(t){this.forEach(function(e){e.classList.remove(t)})},t.prototype.getValue=function(t,e){return void 0===e?1===this.elems.length?t.get(this.elems[0]):(ret=[],this.forEach(function(e){ret.push(t.get(e.innerHTML))}),ret):(this.forEach(function(n){t.set(n,e)}),this)},t.prototype.html=function(t){if(void 0===t)return 1===this.elems.length?this.elems[0].innerHTML:(ret=[],this.forEach(function(t){ret.push(t.innerHTML)}),ret);this.forEach(function(e){e.innerHTML=t})},t.prototype.value=function(t){if(void 0===t)return 1===this.elems.length?this.elems[0].value:(ret=[],this.forEach(function(t){ret.push(t.value)}),ret);this.forEach(function(e){e.value=t})},t.prototype.attr=function(t,e){return this.getValue({get:function(e){return e.getAttribute(t)},set:function(e,n){return e.setAttribute(t,n)}},e)},e.ajax=function(t){var e=new XMLHttpRequest;e.open(t.method||"GET",t.url,!0),e.responseType="json",e.addEventListener("readystatechange",function(){if(e.readyState===XMLHttpRequest.DONE){if(200!==e.status||!t.success)throw new Error(t.url+" responsed with "+e.status+" status");t.success(e.response)}}),e.send(null)};var s=e("#totop");function r(t){for(var e=t.offsetTop;t.offsetParent;)e+=(t=t.offsetParent).offsetTop;return e}s.click(function(){var t,e,s,r;t=n(),e=0,s=t/10,r=setInterval(function(){e>=10&&clearInterval(r),window.scrollTo(0,0|Math.ceil(t-s*e++))},20)});var o=e("#main-nav"),i=r(o.elems[0]);function a(){var t=n();!function(t){t>i?o.addClass("fixed"):(o.removeClass("fixed"),i=r(o.elems[0]))}(t),t>200&&!s.hasClass("show")&&s.addClass("show"),t<150&&s.hasClass("show")&&s.removeClass("show")}e(document).scroll(a).load(a);var c=e(".overlay"),l={$:c,show:function(){c.addClass("show")},hide:function(){c.removeClass("show")},isShowing:function(){c.hasClass("show")}},u=e("#btn-collapse"),h=e("#main-nav-list"),f=e("#btn-close-menu"),d=function(){h.addClass("show"),l.show()},p=function(){h.removeClass("show"),l.hide()},v=function(){return h.hasClass("show")};u.click(function(){d()}),f.click(function(){p()}),l.$.click(function(){v()&&p()});var m=e("#search-panel"),g=e("#btn-search"),w=e("#search-input"),y=e("#search-result"),C=e("#btn-clear-search"),E=e("#search-inner"),L=e("#search-loading"),b=e("#search-no-result-hint"),k=!1,x=!1,T={hide:function(){m.removeClass("show"),l.hide(),b.removeClass("show"),L.removeClass("show")},show:function(){m.addClass("show"),l.show(),k&&b.addClass("show"),x&&L.addClass("show")},isShowing:function(){return m.hasClass("show")},empty:function(){k=!1,b.removeClass("show"),y.html(""),E.addClass("empty")},unEmpty:function(){E.removeClass("empty")},startLoading:function(){x=!0,L.addClass("show"),this.unEmpty()},stopLoading:function(){x=!1,L.removeClass("show")},setResult:function(t){y.html(t),this.unEmpty(),""===t?(b.addClass("show"),k=!0):(b.removeClass("show"),k=!1)},setNoResult:function(){},search:function(t){!function t(n,s){var r;try{r=new RegExp(n.replace(/[ ]+/g,"|"),"gmi")}catch(t){return}if(M){for(var o=[],i=0;i<M.length;i++){var a=S(M[i],r);a&&o.push(a)}s(o)}else T.startLoading(),e.ajax({url:j,success:function(e){M=e,T.stopLoading(),t(w.value(),s)}})}(t,function(t){if(t.length){for(var e="",n=0;n<t.length;n++)e+=["<li>",'<a href="'+t[n].path+'" class="search-result-entry">',t[n].toString(),"</a>","</li>"].join("");T.setResult(e)}else T.setResult("")})}};function A(t,e,n){this.path=t,this.title=e,this.content=n}m.click(function(t){("search-panel"===t.target.id||"search-inner"===t.target.id)&&T.hide()}),g.click(function(){T.show()}),A.prototype.toString=function(){return'<span class="title">'+this.title+"</span>"+this.content};var M=null,R=/[a-zA-Z0-9-]/;function H(t,e,n,s){var r=e.exec(t);if(n>>=1,r){for(var o="",i=0,a=[],c=!0;r;){if(r.index>i&&a.push({start:i,len:r.index-i}),c)c=!1;else if(r.index===i)break;a.push(r[0]),i=r.index+r[0].length,r=e.exec(t)}i<t.length&&a.push({start:i,len:t.length-i});for(var l=0;l<a.length;l++){var u=a[l];if(s>0&&o.length>s){o+="⋯";break}if("string"==typeof u)o+='<span class="keyword">'+u+"</span>";else if(n>0&&u.len>2*n){for(var h=u.start+u.len,f=u.start+n,d=u.start+u.len-n;f<h&&R.test(t.charAt(f));)f++;for(;d>u.start&&R.test(t.charAt(d));)d--;f<d?(o+=t.substr(u.start,f-u.start),o+="⋯",o+=t.substr(d,h-d)):o+=t.substr(u.start,u.len)}else o+=t.substr(u.start,u.len)}return o}return""}function S(t,e){var n=H(t.title,e,-1,-1),s=H(t.content,e,20,2048);return""!==n||""!==s?(""===n&&(n=t.title),new A(t.path,n,s)):null}var j=document.currentScript.getAttribute("data-index-json");C.click(function(){""===w.value()?T.hide():(w.value(""),T.empty())}),w.input(function(){if(!x){var t=this.value.trim();t.length>0?T.search(t):T.empty()}});var N=e(".btn-popup"),B=[];N.click(function(){var t=e(this);e(t.attr("data-target")).addClass("show")}),N.forEach(function(t){(t=e(e(t).attr("data-target")))&&B.push(t)}),e(document).click(function(t){for(var e=t.target.id,n=0;n<B.length;n++)e!==B[n].elems[0].id&&e!==N.elems[n].id&&B[n].removeClass("show")})});
